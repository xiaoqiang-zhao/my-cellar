<!DOCTYPE html>
<html>
<head lang="zh-cn">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>一篇文章读懂 ppi dpr rem 栅格 响应式 - 小强赵的个人站点</title>
    <script>
        // 用户通过搜索引擎到文章详情页时，跳到首页并进行哈希路由
        var href = window.location.href.replace(/[^:|\/]\//,function (matchStr){
            return matchStr + 'index.html#!';
        });
        window.location.href = href.replace('/main.html', '');
    </script>
</head>
<body>
<header>
    <h1> 小强赵的个人站点 </h1>
    <h2> 精进自己，服务他人 </h2>
</header>
<div>
    <h1 id="header-1">一篇文章读懂 ppi dpr rem 栅格 响应式</h1>
<blockquote>
<p>从原理上解释问题的成因，从问题引出解决方案，讲透ppi、dpr、rem、栅格、响应式等概念，知其然之气所以然。</p>
</blockquote>
<h2 id="header-1-1">像素理论</h2>
<p>对像素的理解可能在不同场景下有所不同，这里所说的像素是物理发光单元的意思，每个发光单元只能发出一种光，也就是说你不能有 0.5 这种概念，一个发光单元不能一半发绿光一半发红光。注意这里说的像素和我们写代码时用的“px”不是一回事，这里我把一个物理发光单元称为一物理像素。下面我们来看看各种手机的官方给出的物理像素：</p>
<p>iPhone: 320 x 480  163ppi 1dpr   (2007年)</p>
<p>iPhone4: 640 x 960  326ppi 2dpr 320   (2010年)</p>
<p>iPhone5(s): 640 x 1136  326ppi 2dpr   (2012年)</p>
<p>iPhone6: 750 x 1334  326ppi 2dpr 375   (2014年)</p>
<p>iPhone6 Plus: 1080 x 1920  401ppi 3dpr 360   (2014年)</p>
<p>iPhone7 Plus: 1080 x 1920  401ppi 3dpr   (2016年)</p>
<p>iPhone X: 1125 x 2436 458ppi 3dpr   (2017年)</p>
<p>小米Max: 1080 x 2160  401ppi</p>
<p>小米8: 1080 x 2248  401ppi</p>
<p>OPPO R11: 1080 x 1920</p>
<p>手机发布的时候这是一个很重要的参数，这个参数几乎可以和图像清晰度划等号。</p>
<p>这里还有一个有趣的诡异的蛋疼的问题，iPhone6 Plus 和 iPhone7 Plus 官方给的横向物理像素数量是 1080 但是实际手机截屏出来的图片却是 1242，到底以哪个为准？这需要 ppi 和 drp 的相关知识，后面我单拿出来一章讲这个问题。</p>
<h2 id="header-1-2">PPI 理论</h2>
<p>PPI 是 Pixel Per Inch by diagonal 的缩写，也就是对角线单位长度上的像素点。还有一种说法是“折算到对角线上的像素数”，一般认为发光原件是正方形的，那么在物理世界中一定长度的屏幕一行的像素单元是可以数出来的，但同样有一个问题，那就是相同像素密度的液晶屏会因为形状不同 ppi 可能会不同。两种解释都不影响我们往下理解，记住它代表像素密度就可以了。</p>
<p>液晶屏发展本来很平稳，苹果凭借其对供配件应商强大的话语权率先打破了这种平静，2010 年乔布斯发布 iPhone4 的时候发明了个营销术语 -- “视网膜屏(Retina)”，达到了 326 ppi，为什么叫视网膜屏呢，乔布斯说正常人的视网膜分辨率极限是 300ppi，也就是 iPhone4 在分辨率上已经做到了极致。可是后来 iPhone6 Plus 将 ppi 提高到了 401，这又是怎么回事，苹果在做没用的性能炫耀吗？</p>
<p>并不是，其实是当年乔布斯耍了个手段，当年他说的正常人指的是视力 1.0 的正常人，但实际情况是视力 1.0 是正常视力的最低值。等等，我带着眼睛，视力不到 1.0 用着做新的 iPhone 是不是白费了？</p>
<p>放轻松，不白费，近视和远视是可以戴眼镜矫正的，只要你的矫正视力大于 1.0 那视网膜屏就不白费，但如果是弱视就真的白废了。</p>
<p>ppi 引发的问题是相同的物理像素占的物理面积并不相同，也就是说相同的内容你想在不同型号的手机上展现出相同的大小是很困难的，比如同样设置 100px 的容器，7 Plus 就要比 6 更大一点，你问我咋知道的，找了两部手机爬上去量的。</p>
<p>附注：PPI 适合表述某一设备的性能，设备宽高比固定的情况下，通过 PPI 和屏幕尺寸可以计算出物理像素；DPI 表示一平方英寸上的像素点，适合不同设备之间性能的比较。</p>
<h2 id="header-1-3">dpr 和 设备宽度</h2>
<p>ppi 提高之后会带来一个问题，那就是相同字号的文字会变小，比如原来在 163ppi 屏幕下 20px 的字高 1 厘米，那么在 326 ppi 屏幕下会小一半左右，为了给开发提供方便提出了屏幕倍率的概念。原本屏幕宽度是用物理像素来描述的，关系是一对一，现在加入了屏幕倍率的概念，屏幕宽度和物理像素的关系就成了一对二或一对三，这样做的好处是开发不需要关心屏幕倍率，之前怎么写现在怎么写就可以了，在渲染中文字或图像原来一像素的转角现在可以用 4 像素(2 倍屏)或 9 像素(3 倍屏)来描述，使得能够呈现更多细节，视觉上就是更清晰。屏幕倍率还有个很洋气的名字 -- dpr，是屏幕上一行像素点数量和设备宽度的比值。操作系统会给应用这个参数，对于 Web 站点来说这个参数是可以选择用或不用的。在 html 的头中有一个设置：</p>
<pre><code class="lang-html">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;
</code></pre>
<p>设置之后在 CSS 中写的 1px 实际上就已经不是 1 物理像素了，在 dpr 为 2 的屏幕上是 4 物理像素，在 dpr 为 3 的屏幕上是 9 物理像素，对于单色边框影响不大，但是对图片和文字的呈现上可有更多的物理像素做更细致的描述，页面也就更加细腻。</p>
<p>如果不设置，有的浏览器会自动加上(比如手机版 Chrome)，也有一些浏览器会按不设置来处理，常看到的是文字特别小，实际上这种情况下 CSS 中写的 1px 对应 1 物理像素。</p>
<p>你可能听说过 “0.5px 边框画法”这种技术，那如果在 dpr 为 3 的屏幕上还应该有 “0.33px 边框画法”，实际上就是“一物理像素边框画法”，这里不展开给个链接自己看吧: <a href="https://fed.renren.com/2018/03/24/half-of-one-px/" target="_blank">https://fed.renren.com/2018/03/24/half-of-one-px/</a>
。</p>
<h2 id="header-1-4">1080 和 1242</h2>
<p>现在我们来说说 1080 和 1242，iPhone6 Plus 和 iPhone7 Plus 官方给的宽度数据是 1080 但是实际手机截屏出来的图片却是 1242，到底以哪个为准？如果一定要给一个简单粗暴的回答的话那就是 1242 了。</p>
<p>第一代 iPhone 的 ppi 是 163，iPhone 4 的 ppi 是 326(=163x2)，iPhone 4 是 dpr 是 2(也就是双倍屏)，那么按照这个节奏如果出 dpr 是 3 的新机(三倍屏) 的话 ppi 要达到 489(=163x3)，新机 iPhone6 Plus 确确实实是 3 倍屏，但是 ppi 是 401。怎么理解这事呢，我来打个比方，比如现在有一只中性笔芯，原来能画出 163 米的线，然后二代升级后能画出 326 米的线，这其中油的体积是没变的，
后面升级第三代时发生的事情就有意思了，我来 YY 一段对话：</p>
<p>老板：我们的第三代新款笔要是 3 倍笔，要能画出 489 米的线</p>
<p>硬件工程师：现在的技术办不到呀，只能画出 401 米的线</p>
<p>老板：可是 401 米不够 3 倍呀，你能再突破突破吗？</p>
<p>硬件工程师：这个一年内突破不了，要不你等等发布新款</p>
<p>老板：市场等不了呀，装逼要及时，万一被客户发现画不出承诺的线的长度可要出大事的，有办法吗？</p>
<p>硬件工程师：那我多往里灌点油不就行了</p>
<p>老板：好主意</p>
<p>销售：听说你们多灌了油笔管也变长了</p>
<p>老板：是呀，能不能帮我包装包装，把劣势转换成优势</p>
<p>销售：那我们就说更大跟有气度，油量也不要按实报，少报点显得我们技术更牛逼</p>
<p>老板：就这么办吧，也不用和他们解释的太清楚</p>
<p>1080 就是这么个营销概念，其实你不用理解的太细。</p>
<p>附注：1080 这个数字大体是这么来的：1242 x (401/489) = 1018，然后 1018 不能被 3 整除就取了接近的 1080。至于为什么没选更接近的 1020 可能同样出于市场竞品的考虑。ppi 确定的情况下 1242 直接和手机屏幕大小相关，屏幕大小直接决定了手机大小，手机大小又和散热电池等因素密切相关，那就是另一个领域了，这里不展开。</p>
<h2 id="header-1-5">rem</h2>
<h3 id="header-1-5-1">概述</h3>
<p>讲方案之前最好能先搞清楚它解决了什么问题，我从问题开始给你娓娓道来。当前交互设计有这样一个共识：屏幕变大时展示更多的内容优于展示更大的内容，屏幕太小时在保证清晰度和可操作的前提下最大限度的展示更多内容优于保持图文的物理尺寸。我们拿实际项目举个例子，下面是一个项目中的一个信息单元(侵删)：</p>
<h3 id="header-1-5-2">问题一</h3>
<p><img src="/articles/rem/img/card_spec.png" alt="示例"></p>
<p>“屏幕变大时展示更多的内容优于展示更大的内容”这句话比较好理解，如果我们以 iPhone6 的 375 到 iPhone6 Pluse 的 408，那么图片和文字的设备像素(区别于物理像素)是不应该变的，一行可展现的文字应该更多；“屏幕太小时在保证清晰度和可操作的前提下最大限度的展示更多内容优于保持图文的物理尺寸”，如果 iPhone6 的 375 到 iPhone5 的 326，图文的设备像素不变也是一种处理方式，而且大多数时候是不需要变得，但是有些情况下需要在一行内显示比较多的文字，这是第一种要解决的问题。</p>
<p>第一个解决方案是改需求和设计，毕竟没有什么技术难题是产品解决不了的。第二个解决方案是缩放，不是用 CSS3 的 transform scale ，而是在小屏上设备像素小一些，比如大屏上 30px 的图降低 10% 设置成 27px，16px 的文字降低 10% 设置成 14.4px，间距也要同比例的降低，在碎屏时代每种屏幕都写一套样式是很不现实的，这时候就该 rem 登场了。</p>
<p>如果 html 的 font-size 设置成 100px，那么宽设置成 0.3rem 的图片实际呈现的设备像素宽度就是 100*0.3=30px。最后方案就出来了，一般屏和打屏 html <code>font-size:100px;</code>,小屏 <code>font-size:90px</code>。这就是最简化的 rem 方案，实际上手机百度用的就是这个方案，关键代码如下：</p>
<pre><code class="lang-css">html {
    font-size: 100px;
}
@media screen and (max-width: 326px) {
    font-size: 90px;
}
</code></pre>
<p>还有一种升级方案是用 js 设置 html 的 font-size 值，在不同尺寸的屏幕上会获得更平滑的过渡，根据自己的产品来选择要不要使用。不过善意的提醒一句 -- “无必要，勿增加”。</p>
<p>针对上面场景，这种方案有几个需要注意的点：</p>
<p>一、如果有一个地方用了，那么需要全局使用，否则在小屏下某些区域大某些区域小很不协调；</p>
<p>二、设计的时候要在每个地方留出缩放的空间，比如不能有小于 13.3px(13.3*0.9=12px，一般认为小于 12 像素的文字会看不清)的文字；</p>
<p>三、在一些对对齐和居中有严格要求的场景下，由于计算后的小数会四舍五入，可能会出现 0.5 左右设备像素的偏差。</p>
<h3 id="header-1-5-3">问题二</h3>
<p>还有一类比较简单的场景，通知页或临时广告页，向下面这样：</p>
<p><img src="/articles/rem/img/notice.png" alt="示例"></p>
<p>这种场景的问题是：如果图片和文字不成比例会影响设计感。实现方案和上面一样，只是可以把第一个约束条件去掉。</p>
<p>为了不破坏设计感还有一个 vw 的方案，vw 表示设备宽度的 1/100，可以轻松实现等比例放大，并且对 html 的 font-size 没有依赖。只是这个属性在大规模使用的时候要考虑兼容性。</p>
<p>| 兼容性 | Ios | 安卓 |</p>
<p>| ---- | ---- | ---- |</p>
<p>| rem | 4.1+ | 2.1+ |</p>
<p>| vw | 6.1+ | 4.4+ |</p>
<p>通过<a href="https://mta.qq.com/mta/data/device/os" target="_blank">腾讯数据分析</a>来看，如果是面向大众的产品那 vw 还要再等等才能用，安卓 4.4 以下的系统占比为 3% 左右。</p>
<p>再参考一下<a href="https://mtj.baidu.com/data/mobile/device" target="_blank">百度的统计数据</a>，安卓 4.4 以下的系统占比为 2.6% 左右。</p>
<h2 id="header-1-6">栅格化</h2>
<p>栅格化主要解决什么问题呢？给设计提供规范来节约设计成本，配套的前端方案也能节省开发成本。方案的存在有两种场景，一是出现了问题我能解决，二是问题虽然被其他方案解决了但是我能更好的解决，这个“更好”又体现在两个方面 -- 节省成本和效果更好。栅格化方案为第二种场景存在。</p>
<p>栅格化起源于 PC，在移动领域也崭露头角，先来张图：</p>
<p><img src="/articles/rem/img/grids.png" alt="示例"></p>
<p>人为的把页面划分成多个栅格，常用的 PC 端是 12 列，移动端是 6 列，原理上使用百分比，排列组合出很多样式，以移动为例：</p>
<pre><code class="lang-css">cl-6 {
    width: 100%;
}
cl-5 {
    width: 83.33%;
}
...
</code></pre>
<p>由于是用百分比来作为单位，那么小数是必不可少的，布局中出现偏差也就很难避免了，好在在水平方向上出现偏差是一致的，不会出现对不齐的情况。在代码实现上百分比可以被 flex 布局来代替，只是 flex 布局有兼容性问题，直接使用需要 IE9 以上，移动端需要安卓 4.4 及以上。</p>
<h2 id="header-1-7">响应式</h2>
<p>响应式相对简单，就是不同宽度写不同的样式，一般不会全部写两套，只控制关键部分，比如上面用到的这段代码：</p>
<pre><code class="lang-css">html {
    font-size: 100px;
}
@media screen and (max-width: 326px) {
    font-size: 90px;
}
</code></pre>
<p>就是响应式很好的应用。</p>
<p>在一些简单的个人站点中 PC 和移动可以使用一套样式大大节省开发成本，在像淘宝这种复杂的应用中一般是用两套样式的。</p>
<h2 id="header-1-8">参考</h2>
<p><a href="http://caibaojian.com/web-app-rem.html" target="_blank">rem是如何实现自适应布局的？</a></p>
<p><a href="http://blog.csdn.net/qq_31029729/article/details/51424668" target="_blank">移动端适配的方案----flexible</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/32856643" target="_blank">液晶工作原理-大话液晶</a></p>
<p><a href="https://baike.baidu.com/item/%E8%A7%86%E7%BD%91%E8%86%9C%E5%B1%8F%E5%B9%95" target="_blank">Retina</a></p>
<p><a href="https://support.apple.com/zh-cn/HT201296" target="_blank">iPhone 技术规格</a></p>
<p><a href="https://stackoverflow.com/questions/25755443/iphone-6-plus-resolution-confusion-xcode-or-apples-website-for-development" target="_blank">iPhone 6 Plus 1080 1242</a></p>
<p><a href="https://blog.csdn.net/s0228g0228/article/details/52995881" target="_blank">iPhone6 6p 7 7p屏幕适配，切图准则</a></p>
<p><a href="http://imweb.io/topic/5745adf5a94f742c1db63485" target="_blank">rem不是神农草，治不了移动端百病</a></p>
<p><a href="https://www.jianshu.com/p/1a9b5d48afa2" target="_blank">谈谈 rem 与 vw -- rem</a></p>
<p><a href="https://en.wikipedia.org/wiki/Pixel_density" target="_blank">PPI in wikipedia</a></p>

</div>
</body>
</html>