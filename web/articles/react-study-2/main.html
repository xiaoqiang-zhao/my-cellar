<!DOCTYPE html>
<html>
<head lang="zh-cn">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>React -- ç¬¬ 2 å¤© -- è¿›é˜¶æŒ‡å¯¼ - å°å¼ºèµµçš„ä¸ªäººç«™ç‚¹</title>
    <script>
        // ç”¨æˆ·é€šè¿‡æœç´¢å¼•æ“åˆ°æ–‡ç« è¯¦æƒ…é¡µæ—¶ï¼Œè·³åˆ°é¦–é¡µå¹¶è¿›è¡Œå“ˆå¸Œè·¯ç”±
        var href = window.location.href.replace(/[^:|\/]\//,function (matchStr){
            return matchStr + 'index.html#!';
        });
        window.location.href = href.replace('/main.html', '');
    </script>
</head>
<body>
<header>
    <h1> å°å¼ºèµµçš„ä¸ªäººç«™ç‚¹ </h1>
    <h2> ç²¾è¿›è‡ªå·±ï¼ŒæœåŠ¡ä»–äºº </h2>
</header>
<div>
    <h1 id="header-1">React -- ç¬¬ 2 å¤© -- è¿›é˜¶æŒ‡å¯¼</h1>
<blockquote>
<p>ä»å®˜ç½‘å¼€å§‹ä¸€æ­¥æ­¥å­¦å®Œ Reactï¼Œè®¡åˆ’ç”¨æ—¶ 3 å¤©ï¼Œç¬¬ 2 å¤© -- è¿›é˜¶æŒ‡å—ã€‚</p>
</blockquote>
<h2 id="header-1-1">æ˜“è¯»æ˜“ç”¨æ€§</h2>
<blockquote>
<p>Accessibility</p>
</blockquote>
<p>å®˜æ–¹æ–‡æ¡£ä»è¿™é‡Œå¼€å§‹ï¼š<a href="https://reactjs.org/docs/accessibility.html" target="_blank">https://reactjs.org/docs/accessibility.html</a></p>
<p>åªæœ‰ html å±æ€§å’Œ data- ä»¥åŠ aria- æ‰ä¼šæ˜¾ç¤ºåœ¨ Dom ä¸­ï¼Œå…¶ä½™çš„ key æˆ–å…¶ä»–ï¼Œæ˜¯æ‰©å±•æ€§è´¨çš„ï¼Œä¾¿äºå‘ä¸‹çº§ç»„ä»¶ä¼ é€’æ•°æ®ã€‚aria æ˜¯ Accessible Rich Internet Applications çš„ç¼©å†™ï¼Œä¸‹é¢ Demo æ¸²æŸ“å‡ºçš„ Dom æ˜¯æœ‰ aria å¼€å¤´çš„å±æ€§çš„ï¼ŒDemo 5.1:</p>
<pre><code class="lang-js">class App extends React.Component {
  constructor(props) {
    super(props);
    this.onchangeHandler = this.onchangeHandler.bind(this);
    this.state = {
      labelText: &#39;labelText&#39;,
      inputValue: &#39;inputValue&#39;
    };
  }

  onchangeHandler(e) {
    this.setState({
      inputValue: e.target.value
    });
  }

  render() {
    return (&lt;input
      type=&quot;text&quot;
      aria-label={this.state.labelText}
      aria-required=&quot;true&quot;
      onChange={this.onchangeHandler}
      value={this.state.inputValue}
      name=&quot;name&quot;
    /&gt;);
  }
}
ReactDOM.render(
  &lt;App/&gt;, 
  document.getElementById(&#39;root&#39;)
);
</code></pre>
<p>æ ‡ç­¾è¯­ä¹‰åŒ–æ›´å¥½çš„è¡¨å•ï¼ŒDemo 5.2:</p>
<pre><code class="lang-js">class App extends React.Component {

  render() {
    return (
      &lt;div&gt;
        &lt;label htmlFor=&quot;namedInput&quot;&gt;Name:&lt;/label&gt;
        &lt;input id=&quot;namedInput&quot; type=&quot;text&quot; name=&quot;name&quot;/&gt;
      &lt;/div&gt;
    );
  }
}
ReactDOM.render(
  &lt;App/&gt;, 
  document.getElementById(&#39;root&#39;)
);
</code></pre>
<p>ç®¡ç†ç„¦ç‚¹ï¼Œç»„ä»¶åˆå§‹åŒ–å®Œæˆ 2 ç§’å input è·å¾—ç„¦ç‚¹ï¼ŒDemo 5.3:</p>
<pre><code class="lang-js">function CustomTextInput(props) {
  return (
    &lt;div&gt;
      &lt;input ref={props.inputRef} /&gt;
    &lt;/div&gt;
  );
}

class App extends React.Component {
  constructor(props) {
    super(props);
    this.inputElement = React.createRef();

    setTimeout(() =&gt; {
      this.inputElement.current.focus();
    }, 2000);
  }
  render() {
    return (
      &lt;CustomTextInput inputRef={this.inputElement} /&gt;
    );
  }
}
ReactDOM.render(
  &lt;App/&gt;, 
  document.getElementById(&#39;root&#39;)
);
</code></pre>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç‚¹å‡»ç©ºç™½å¤„å…³é—­å¼¹æ¡†çš„ä¾‹å­ï¼ŒDemo 5.4:</p>
<pre><code class="lang-js">class OuterClickExample extends React.Component {
  constructor(props) {
    super(props);

    this.state = { isOpen: false };
    this.toggleContainer = React.createRef();

    this.onClickHandler = this.onClickHandler.bind(this);
    this.onClickOutsideHandler = this.onClickOutsideHandler.bind(this);
  }

  componentDidMount() {
    window.addEventListener(&#39;click&#39;, this.onClickOutsideHandler);
  }

  componentWillUnmount() {
    window.removeEventListener(&#39;click&#39;, this.onClickOutsideHandler);
  }

  onClickHandler() {
    this.setState(currentState =&gt; ({
      isOpen: !currentState.isOpen
    }));
  }

  onClickOutsideHandler(event) {
    if (this.state.isOpen &amp;&amp; !this.toggleContainer.current.contains(event.target)) {
      this.setState({ isOpen: false });
    }
  }

  render() {
    return (
      &lt;div ref={this.toggleContainer}&gt;
        &lt;button onClick={this.onClickHandler}&gt;Select an option&lt;/button&gt;
        {this.state.isOpen ? (
          &lt;ul&gt;
            &lt;li&gt;Option 1&lt;/li&gt;
            &lt;li&gt;Option 2&lt;/li&gt;
            &lt;li&gt;Option 3&lt;/li&gt;
          &lt;/ul&gt;
        ) : null}
      &lt;/div&gt;
    );
  }
}
ReactDOM.render(
  &lt;OuterClickExample/&gt;, 
  document.getElementById(&#39;root&#39;)
);
</code></pre>
<h2 id="header-1-2">ä»£ç åˆ†å‰²</h2>
<blockquote>
<p>Code-Splitting</p>
</blockquote>
<p>å¤§å‹é¡¹ç›®ä¸å¯èƒ½å…¨éƒ¨é€»è¾‘æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å¯¹å¤–è¾“å‡ºï¼Œè¿™æ—¶å°±éœ€è¦ä»£ç åˆ†å‰²äº†ã€‚æˆ‘ä»¬ç”¨çš„æ˜¯å®˜æ–¹æä¾›çš„é¡¹ç›®ç”Ÿæˆå·¥å…· create-react-appï¼Œéœ€è¦åœ¨ç”Ÿæˆçš„é¡¹ç›®ä¸­æ·»åŠ ä¸¤ä¸ªä¾èµ–åŒ…ï¼š</p>
<pre><code class="lang-shell">yarn add react-router-dom --dev
yarn add react-loadable --dev
</code></pre>
<p>ä½¿ç”¨è¿™ç§æ–¹å¼å°±å¯ä»¥å°†ä»£ç æ‰“åŒ…æˆå¤šä¸ª chunkï¼ŒåŒäº‹æ¼”ç¤ºäº†è·¯ç”±çš„ç”¨æ³•ï¼Œè¿è¡Œ yarn build å¯ä»¥æŸ¥çœ‹æ‰“åŒ…ç»“æœï¼ŒDemo 5.5</p>
<pre><code class="lang-js">import { BrowserRouter as Router, Route, Link } from &quot;react-router-dom&quot;;
import Loadable from &#39;react-loadable&#39;;

const App = () =&gt; (
  &lt;Router&gt;
    &lt;div&gt;
      &lt;ul&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/&quot;&gt;Home&lt;/Link&gt;
        &lt;/li&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/about&quot;&gt;About&lt;/Link&gt;
        &lt;/li&gt;
      &lt;/ul&gt;

      &lt;hr /&gt;

      &lt;Route exact path=&quot;/&quot; component={Home} /&gt;
      &lt;Route path=&quot;/about&quot; component={About} /&gt;
    &lt;/div&gt;
  &lt;/Router&gt;
);

const Loading = () =&gt; &lt;div&gt;Loading...&lt;/div&gt;;
const Home = Loadable({
  loader: () =&gt; import(&#39;./routes/Home.js&#39;),
  loading: Loading,
});

const About = () =&gt; (
  &lt;div&gt;
    &lt;h2&gt;About&lt;/h2&gt;
  &lt;/div&gt;
);

ReactDOM.render(
  &lt;App/&gt;, 
  document.getElementById(&#39;root&#39;)
);
</code></pre>
<p>è¡¥å……ç¤ºä¾‹ routes/Home.js ä¸­çš„ä»£ç </p>
<pre><code class="lang-js">import React, { Component}  from &#39;react&#39;;

class Home extends Component {
  render() {
    return (
      &lt;div&gt;
        &lt;h2&gt;Home&lt;/h2&gt;
      &lt;/div&gt;
    );
  }
}

export default Home;
</code></pre>
<h2 id="header-1-3">ä¸Šä¸‹æ–‡(Context)</h2>
<p>ä¸ºäº†è§£å†³ç»„ä»¶è·¨å±‚ä¼ é€’æ•°æ®çš„é—®é¢˜ï¼Œå®˜æ–¹è¯´ç»„ä»¶ä¹‹é—´çš„ top-down (parent to child) (ä¹Ÿå°±æ˜¯ä»ä¸Šåˆ°ä¸‹æ•°æ®æµ)è¿™åœ¨æŸäº›åœºæ™¯ä¸‹æ˜¯ cumbersome(ç¬¨é‡) çš„ã€‚ç›¸å½“äºå…¨å±€å˜é‡ï¼Œè¢«ç”¨åœ¨ ä¸»é¢˜ã€ç”¨æˆ· è¿™ç±»æ•°æ®ä¸Šã€‚</p>
<p>ä¸‹é¢æ˜¯ä» App ç»„ä»¶ï¼Œç•¥è¿‡ Toolbar ç»„ä»¶ç›´æ¥å°† theme åˆ° ThemedButton ç»„ä»¶ï¼Œå¯ä»¥çœ‹åˆ° Toolbar ç»„ä»¶å¯¹ theme æ˜¯æ— æ„Ÿçš„ï¼ŒDemo 5.6:</p>
<pre><code class="lang-js">const ThemeContext = React.createContext(&#39;light&#39;);
function Toolbar() {
  return (
    &lt;div&gt;
      &lt;ThemedButton/&gt;
    &lt;/div&gt;
  );
}
function ThemedButton(props) {
  return (
    &lt;ThemeContext.Consumer&gt;
      {theme =&gt;
        &lt;div className={theme}&gt;{theme}&lt;/div&gt;
      }
    &lt;/ThemeContext.Consumer&gt;
  );
}
class App extends React.Component {
  render() {
    return (
      &lt;ThemeContext.Provider value=&quot;dark&quot;&gt;
        &lt;Toolbar/&gt;
      &lt;/ThemeContext.Provider&gt;
    );
  }
}
ReactDOM.render(
  &lt;App/&gt;, 
  document.getElementById(&#39;root&#39;)
);
</code></pre>
<h2 id="header-1-4">é”™è¯¯å½±å“æœ€å°åŒ–</h2>
<blockquote>
<p>Error Boundaries</p>
</blockquote>
<p>é”™è¯¯çš„è¾¹ç•Œï¼Œå…¶å®å°±æ˜¯æŠŠé”™è¯¯å›´èµ·æ¥ï¼Œä¸è®©å®ƒè·‘åˆ°å¤–é¢åšåäº‹ã€‚</p>
<pre><code class="lang-js">class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false };
  }

  componentDidCatch(error, info) {
    // Display fallback UI
    this.setState({ hasError: true });
    // You can also log the error to an error reporting service
    logErrorToMyService(error, info);
  }

  render() {
    if (this.state.hasError) {
      // You can render any custom fallback UI
      return &lt;h1&gt;Something went wrong.&lt;/h1&gt;;
    }
    return this.props.children;
  }
}
&lt;ErrorBoundary&gt;
  &lt;MyWidget /&gt;
&lt;/ErrorBoundary&gt;
</code></pre>
<h2 id="header-1-5">ç›´æ¥ç´¢å¼•</h2>
<blockquote>
<p>Forwarding Refs</p>
</blockquote>
<p>ç›´æ¥ç´¢å¼• Domï¼ŒDemo 6.1</p>
<pre><code class="lang-js">const FancyButton = React.forwardRef((props, ref) =&gt; (
  &lt;button ref={ref} className=&quot;FancyButton&quot;&gt;
    {props.children}
  &lt;/button&gt;
));

// You can now get a ref directly to the DOM button:
const ref = React.createRef();
ReactDOM.render(&lt;FancyButton ref={ref}&gt;Click me!&lt;/FancyButton&gt;, document.getElementById(&#39;root&#39;));
console.log(document.getElementsByTagName(&#39;button&#39;)[0] === ref.current);
// true
</code></pre>
<p>React ç»„ä»¶çš„å°è£…æ€§å†³å®šäº†çˆ¶ç»„ä»¶æ˜¯ä¸èƒ½ç›´æ¥è®¿é—®å­ç»„ä»¶çš„ Dom çš„ï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µéœ€è¦æ“ä½œï¼Œæ¯”å¦‚è·å¾—ç„¦ç‚¹ã€‚å¯¹æ¯” Vue ç›´æ¥è¿”å›ç»„ä»¶å¯¹è±¡ï¼Œè¿™ä¸ªæ˜¾ç„¶è¦åŸå§‹ä¸€äº›ã€‚</p>
<h2 id="header-1-6">ç‰‡æ®µ</h2>
<blockquote>
<p>Fragmentsï¼Œç»„ä»¶å¯ä»¥è¿”å› Dom ç‰‡æ®µï¼Œå½“æœ‰ä¸åœ¨ä¸€ä¸ª Dom èŠ‚ç‚¹ä¸‹çš„æ—¶å€™å¯ä»¥ç”¨ React.Fragment æ ‡ç­¾åŒ…è£¹èµ·æ¥ã€‚</p>
</blockquote>
<p>Demo 6.2</p>
<pre><code class="lang-js">class Columns extends React.Component {
  render() {
    return (
      &lt;React.Fragment&gt;
        &lt;td&gt;Hello&lt;/td&gt;
        &lt;td&gt;World&lt;/td&gt;
      &lt;/React.Fragment&gt;
    );
  }
}

class Table extends React.Component {
  render() {
    return (
      &lt;table&gt;
        &lt;tbody&gt;
          &lt;tr&gt;
            &lt;Columns /&gt;
          &lt;/tr&gt;
        &lt;/tbody&gt;
      &lt;/table&gt;
    );
  }
}
ReactDOM.render(&lt;Table/&gt;, document.getElementById(&#39;root&#39;));
</code></pre>
<p>React.Fragment æ ‡ç­¾å¯ä»¥ç®€å†™ï¼Œä¸ä¼šå‡ºç°é¢å¤–çš„æ ‡ç­¾ï¼š</p>
<pre><code class="lang-js">class Columns extends React.Component {
  render() {
    return (
      &lt;&gt;
        &lt;td&gt;Hello&lt;/td&gt;
        &lt;td&gt;World&lt;/td&gt;
      &lt;/&gt;
    );
  }
}
</code></pre>
<h2 id="header-1-7">æ•´åˆå…¶ä»–åº“</h2>
<blockquote>
<p>Integrating with Other Libraries</p>
</blockquote>
<p>ç”±äºä¸€äº›å†å²åŸå› ä½ å¯èƒ½æœ‰ä¸€äº›å…¶ä»–æ¡†æ¶çš„ä»£ç ï¼Œæ¯”å¦‚ jQueryã€Backbone ç­‰ï¼Œä¸ºäº†å¤ç”¨è¿™äº›ä»£ç çœ‹çœ‹æ€ä¹ˆæŠŠä»–ä»¬é›†æˆåˆ° React å·¥ç¨‹ä¸­ã€‚ä½ å¯ä»¥ç”¨ä¸€ä¸ªç©ºçš„ divï¼ŒDemo 6.3</p>
<pre><code class="lang-js">class SomePlugin extends React.Component {
  componentDidMount() {
    // è¿™é‡Œå¯ä»¥ç”¨ jQuery, ç„¶åå†åšç‚¹ä»€ä¹ˆ
    // this.$el = $(this.el);

    // ä¹Ÿå¯ä»¥ç”¨åŸç”Ÿçš„ js æ¥æ“ä½œDom
    const H1 = document.createElement(&#39;h1&#39;);
    H1.innerText = &#39;åŸç”Ÿ JS ç”Ÿæˆçš„æ ‡ç­¾&#39;;
    console.log(this.el);
    this.el.appendChild(H1);
  }

  render() {
    return &lt;div ref={el =&gt; this.el = el}/&gt;;
  }
}
ReactDOM.render(&lt;SomePlugin/&gt;, document.getElementById(&#39;root&#39;));
</code></pre>
<h2 id="header-1-8">æ·±å…¥ç†è§£ JSX</h2>
<blockquote>
<p>JSX In Depth</p>
</blockquote>
<p>JSX æä¾›çš„æ˜¯ä¸€ç§è¯­æ³•ç³–</p>
<pre><code class="lang-js">&lt;MyButton color=&quot;blue&quot; shadowSize={2}&gt;
  Click Me
&lt;/MyButton&gt;
</code></pre>
<p>ä¸Šé¢çš„è¿™ç§å†™æ³•å°†è¢«ç¼–è¯‘æˆä¸‹é¢è¿™æ ·</p>
<pre><code class="lang-js">React.createElement(
  MyButton,
  {color: &#39;blue&#39;, shadowSize: 2},
  &#39;Click Me&#39;
)
</code></pre>
<p>å…³äº props ä¹Ÿæœ‰ä¸¤ç§å†™æ³•ï¼Œä»–ä»¬æ˜¯ç­‰ä»·çš„ï¼š</p>
<pre><code class="lang-js">function App() {
  return &lt;Greeting firstName=&quot;Ben&quot; lastName=&quot;Hector&quot; /&gt;;
}
</code></pre>
<p>ğŸ‘†ç­‰ä»·ğŸ‘‡</p>
<pre><code class="lang-js">function App() {
  const props = {firstName: &#39;Ben&#39;, lastName: &#39;Hector&#39;};
  return &lt;Greeting {...props} /&gt;;
}
</code></pre>
<h2 id="header-1-9">æ€§èƒ½ä¼˜åŒ–</h2>
<blockquote>
<p>Optimizing Performance</p>
</blockquote>
<p>åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œä½ çš„ç»„ä»¶å¯ä»¥é€šè¿‡é‡å†™è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°shouldComponentUpdateæ¥æå‡é€Ÿåº¦ï¼Œ å®ƒæ˜¯åœ¨é‡æ–°æ¸²æŸ“è¿‡ç¨‹å¼€å§‹å‰è§¦å‘çš„ã€‚ è¿™ä¸ªå‡½æ•°é»˜è®¤è¿”å›trueï¼Œå¯ä½¿Reactæ‰§è¡Œæ›´æ–°ï¼Œå¦‚æœä½ çŸ¥é“åœ¨æŸäº›æƒ…å†µä¸‹ä½ çš„ç»„ä»¶ä¸éœ€è¦æ›´æ–°ï¼Œä½ å¯ä»¥åœ¨shouldComponentUpdateå†…è¿”å›falseæ¥è·³è¿‡æ•´ä¸ªæ¸²æŸ“è¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹åŒ…æ‹¬äº†å¯¹è¯¥ç»„ä»¶å’Œä¹‹åçš„å†…å®¹è°ƒç”¨render()æŒ‡ä»¤ã€‚ï¼š</p>
<pre><code class="lang-js">shouldComponentUpdate(nextProps, nextState) {
  return true;
}
</code></pre>
<p>è¿˜æœ‰ä¸€ä¸ªæ¦‚å¿µå« â€œImmutable Data Structuresâ€ï¼Œä¸­æ–‡æ–‡æ¡£ç¿»è¯‘æˆ â€œä¸å¯çªå˜çš„æ•°æ®ç»“æ„â€ï¼Œå…¶å®å°±æ˜¯ä¸éœ€è¦å˜çš„ç”¨å¸¸é‡å£°æ˜ã€‚</p>
<h2 id="header-1-10">è·³å‡ºçˆ¶ç»„ä»¶</h2>
<blockquote>
<p>Portals</p>
</blockquote>
<p>ä¸€ç§å°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°çˆ¶ç»„ä»¶ä»¥å¤–çš„ DOM èŠ‚ç‚¹çš„æ–¹å¼ã€‚è¿™å¯¹äºé®ç½©å’Œå¼¹æ¡†ç±»çš„äº¤äº’å¾ˆæœ‰ç”¨ï¼ŒDemo 6.4</p>
<pre><code class="lang-js">const modalRoot = document.getElementById(&#39;modal-root&#39;);

// Let&#39;s create a Modal component that is an abstraction around
// the portal API.
class Modal extends React.Component {
  constructor(props) {
    super(props);
    // Create a div that we&#39;ll render the modal into. Because each
    // Modal component has its own element, we can render multiple
    // modal components into the modal container.
    this.el = document.createElement(&#39;div&#39;);
  }

  componentDidMount() {
    // Append the element into the DOM on mount. We&#39;ll render
    // into the modal container element (see the HTML tab).
    modalRoot.appendChild(this.el);
  }

  componentWillUnmount() {
    // Remove the element from the DOM when we unmount
    modalRoot.removeChild(this.el);
  }

  render() {
    // Use a portal to render the children into the element
    return ReactDOM.createPortal(
      // Any valid React child: JSX, strings, arrays, etc.
      this.props.children,
      // A DOM element
      this.el,
    );
  }
}
</code></pre>
<h2 id="header-1-11">ç»“è¯­</h2>
<p>React è§‚å¿µå’Œ API å±‚æ¬¡å°±å­¦å®Œäº†ï¼Œæ‰‹å¤´è¿˜æ²¡æœ‰ React çš„é¡¹ç›®ï¼Œæ€è€ƒäº†å¾ˆå¤šå­¦ä¹ äº†å¾ˆå¤šã€‚</p>

</div>
</body>
</html>